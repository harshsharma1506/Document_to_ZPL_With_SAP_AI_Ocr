# ðŸ§¾ SAP Document AI Label Generator

This project integrates with **SAP Document Information Extraction (DOX)** service to extract key fields from purchase order documents and generate a **professional shipping label** in **ZPL (Zebra Programming Language)** format. The label is then converted to **PDF using Labelary API** for preview and printing.

## ðŸš€ Features

- ðŸ“„ Uploads and processes PO documents (`.txt`/`.pdf`) via SAP DOX
- ðŸ§  Uses schema-based AI model to extract:
  - Sender Name, Address, Email
  - PO Number, Date, Net Amount, Currency
  - Line Item Description, Quantity, Unit Price
- ðŸŽ¯ Dynamically generates a clean ZPL shipping label
- ðŸ”„ Converts ZPL to PDF using Labelary
- âœ… Secure token-based authentication using `.env`
- ðŸ“¦ Generates result label with QR code and barcode

## ðŸ“¸ Screenshots

- `label.pdf` preview
  <img width="659" height="819" alt="{4445163C-0418-4E56-8C61-E74FD14F397F}" src="https://github.com/user-attachments/assets/96e83d84-eeae-40fd-bea4-1f446dc835e7" />

- Terminal output during job polling and label generation

  First the job is created for DOX 
  <img width="1153" height="169" alt="{F3EFEABB-B1C1-43C3-8C15-9D5CB85C9757}" src="https://github.com/user-attachments/assets/5e892d18-faf0-4479-a012-50f971886a96" />

  Tracking that job as the document is posted
  <img width="692" height="108" alt="{FE588D8E-70EA-43E9-BF11-66CDEAE89940}" src="https://github.com/user-attachments/assets/129badf8-a48a-4286-8297-cc5c952972ae" />

  JSON response 
```json
{'bocrVersion': '2.43.0',
 'clientId': 'default',
 'country': 'US',
 'created': '2025-08-06T17:37:45.323820+00:00',
 'dataForRetrainingStatus': 'notUsedForTraining',
 'documentType': 'purchaseOrder',
 'doxVersion': '2.0.0-2ca351f',
 'extraction': {'headerFields': [{'category': 'document',
                                  'confidence': 0.9202054341634115,
                                  'coordinates': {'h': 0.012500000000000011,
                                                  'w': 0.14264705882352938,
                                                  'x': 0.20784313725490197,
                                                  'y': 0.30037878787878786},
                                  'description': 'documentDate',
                                  'label': 'documentDate',
                                  'model': 'ai',
                                  'name': 'documentDate',
                                  'page': 1,
                                  'rawValue': 'April 24, 2024',
                                  'type': 'date',
                                  'value': '2024-04-24'},
                                 {'category': 'document',
                                  'confidence': 0.9181744456291199,
                                  'coordinates': {'h': 0.009848484848484829,
                                                  'w': 0.05980392156862749,
                                                  'x': 0.22941176470588234,
                                                  'y': 0.2859848484848485},
                                  'description': 'documentNumber',
                                  'label': 'documentNumber',
                                  'model': 'ai',
                                  'name': 'documentNumber',
                                  'page': 1,
                                  'rawValue': '123456',
                                  'type': 'string',
                                  'value': '123456'},
                                 {'category': 'amounts',
                                  'confidence': 0.8721463680267334,
                                  'coordinates': {'h': 0.010984848484848486,
                                                  'w': 0.08970588235294114,
                                                  'x': 0.26029411764705884,
                                                  'y': 0.40643939393939393},
                                  'description': 'netAmount',
                                  'label': 'netAmount',
                                  'model': 'ai',
                                  'name': 'netAmount',
                                  'page': 1,
                                  'rawValue': '$1,625.00',
                                  'type': 'number',
                                  'value': 1625.0},
                                 {'category': 'sender',
                                  'confidence': 0.8994693458080292,
                                  'coordinates': {'h': 0.013636363636363641,
                                                  'w': 0.15294117647058822,
                                                  'x': 0.11568627450980393,
                                                  'y': 0.11969696969696969},
                                  'description': 'senderName',
                                  'label': 'senderName',
                                  'model': 'ai',
                                  'name': 'senderName',
                                  'page': 1,
                                  'rawValue': 'XYZ Corporation',
                                  'type': 'string',
                                  'value': 'XYZ Corporation'},
                                 {'category': 'sender',
                                  'confidence': 0.579728364944458,
                                  'coordinates': {'h': 0.013636363636363669,
                                                  'w': 0.2661764705882353,
                                                  'x': 0.44607843137254904,
                                                  'y': 0.6761363636363636},
                                  'description': 'senderEmail',
                                  'label': 'senderEmail',
                                  'model': 'ai',
                                  'name': 'senderEmail',
                                  'page': 1,
                                  'rawValue': 'support@xyzcorporation.com',
                                  'type': 'string',
                                  'value': 'support@xyzcorporation.com'},
                                 {'category': 'amounts',
                                  'confidence': 0.9094622731208801,
                                  'coordinates': {'h': 0.0,
                                                  'w': 0.0,
                                                  'x': 0.0,
                                                  'y': 0.0},
                                  'description': 'currencyCode',
                                  'label': 'currencyCode',
                                  'model': 'ai',
                                  'name': 'currencyCode',
                                  'page': 1,
                                  'rawValue': 'USD',
                                  'type': 'string',
                                  'value': 'USD'},
                                 {'category': 'sender',
                                  'confidence': 0.8986014624436697,
                                  'coordinates': {'h': 0.02765151515151515,
                                                  'w': 0.18284313725490195,
                                                  'x': 0.1161764705882353,
                                                  'y': 0.13560606060606062},
                                  'description': 'senderAddress',
                                  'label': 'senderAddress',
                                  'model': 'ai',
                                  'name': 'senderAddress',
                                  'page': 1,
                                  'rawValue': '100 Main Street Anytown, USA '
                                              '12345',
                                  'type': 'string',
                                  'value': '100 Main Street Anytown, USA '
                                           '12345'},
                                 {'category': 'sender',
                                  'confidence': 0.83,
                                  'coordinates': {'h': 0.012499988079071045,
                                                  'w': 0.07549019157886505,
                                                  'x': 0.11715686321258545,
                                                  'y': 0.1507575809955597},
                                  'description': 'senderCity',
                                  'label': 'senderCity',
                                  'model': 'ai',
                                  'name': 'senderCity',
                                  'page': 1,
                                  'rawValue': 'Anytown,',
                                  'type': 'string',
                                  'value': 'Anytown,'},
                                 {'category': 'sender',
                                  'confidence': 0.99,
                                  'coordinates': {'h': 0.012121200561523438,
                                                  'w': 0.029901966452598572,
                                                  'x': 0.2083333283662796,
                                                  'y': 0.15037879347801208},
                                  'description': 'senderCountryCode',
                                  'label': 'senderCountryCode',
                                  'model': 'ai',
                                  'name': 'senderCountryCode',
                                  'page': 1,
                                  'rawValue': 'US',
                                  'type': 'string',
                                  'value': 'US'},
                                 {'category': 'sender',
                                  'confidence': 0.98,
                                  'coordinates': {'h': 0.0102272629737854,
                                                  'w': 0.027941182255744934,
                                                  'x': 0.11617647111415863,
                                                  'y': 0.1356060653924942},
                                  'description': 'senderHouseNumber',
                                  'label': 'senderHouseNumber',
                                  'model': 'ai',
                                  'name': 'senderHouseNumber',
                                  'page': 1,
                                  'rawValue': '100',
                                  'type': 'string',
                                  'value': '100'},
                                 {'category': 'sender',
                                  'confidence': 1.0,
                                  'coordinates': {'h': 0.0102272629737854,
                                                  'w': 0.11225488781929016,
                                                  'x': 0.1558823585510254,
                                                  'y': 0.1359848529100418},
                                  'description': 'senderStreet',
                                  'label': 'senderStreet',
                                  'model': 'ai',
                                  'name': 'senderStreet',
                                  'page': 1,
                                  'rawValue': 'Main Street',
                                  'type': 'string',
                                  'value': 'Main Street'},
                                 {'category': 'sender',
                                  'confidence': 0.99,
                                  'coordinates': {'h': 0.012121200561523438,
                                                  'w': 0.04852941632270813,
                                                  'x': 0.2504901885986328,
                                                  'y': 0.15000000596046448},
                                  'description': 'senderPostalCode',
                                  'label': 'senderPostalCode',
                                  'model': 'ai',
                                  'name': 'senderPostalCode',
                                  'page': 1,
                                  'rawValue': '12345',
                                  'type': 'string',
                                  'value': '12345'}],
                'lineItems': [[{'category': 'item',
                                'confidence': 0.46737274527549744,
                                'coordinates': {'h': 0.012121212121212144,
                                                'w': 0.03627450980392158,
                                                'x': 0.11813725490196078,
                                                'y': 0.36098484848484846},
                                'description': 'itemNumber',
                                'label': 'itemNumber',
                                'model': 'ai',
                                'name': 'itemNumber',
                                'page': 1,
                                'rawValue': '1001',
                                'type': 'string',
                                'value': '1001'},
                               {'category': 'details',
                                'confidence': 0.7036878565947214,
                                'coordinates': {'h': 0.012500000000000011,
                                                'w': 0.13627450980392158,
                                                'x': 0.17352941176470588,
                                                'y': 0.3606060606060606},
                                'description': 'description',
                                'label': 'description',
                                'model': 'ai',
                                'name': 'description',
                                'page': 1,
                                'rawValue': 'Widget A 50',
                                'type': 'string',
                                'value': 'Widget A 50'},
                               {'category': 'details',
                                'confidence': 0.8985098004341125,
                                'coordinates': {'h': 0.012121212121212144,
                                                'w': 0.05882352941176472,
                                                'x': 0.3514705882352941,
                                                'y': 0.3606060606060606},
                                'description': 'quantity',
                                'label': 'quantity',
                                'model': 'ai',
                                'name': 'quantity',
                                'page': 1,
                                'rawValue': '$10.00',
                                'type': 'number',
                                'value': 10.0},
                               {'category': 'details',
                                'confidence': 0.8409008979797363,
                                'coordinates': {'h': 0.012121212121212144,
                                                'w': 0.06862745098039214,
                                                'x': 0.46911764705882353,
                                                'y': 0.3606060606060606},
                                'description': 'unitPrice',
                                'label': 'unitPrice',
                                'model': 'ai',
                                'name': 'unitPrice',
                                'page': 1,
                                'rawValue': '$500.00',
                                'type': 'number',
                                'value': 500.0}],
                              [{'category': 'details',
                                'confidence': 0.6700574457645416,
                                'coordinates': {'h': 0.012878787878787878,
                                                'w': 0.06323529411764706,
                                                'x': 0.2465686274509804,
                                                'y': 0.37537878787878787},
                                'description': 'description',
                                'label': 'description',
                                'model': 'ai',
                                'name': 'description',
                                'page': 1,
                                'rawValue': 'B 75',
                                'type': 'string',
                                'value': 'B 75'},
                               {'category': 'details',
                                'confidence': 0.6637594699859619,
                                'coordinates': {'h': 0.012878787878787878,
                                                'w': 0.06029411764705883,
                                                'x': 0.17401960784313725,
                                                'y': 0.37537878787878787},
                                'description': 'The senderMaterialNumber line '
                                               'item field is deprecated and '
                                               'instead, the '
                                               'customerMaterialNumber line '
                                               'item field should be used.',
                                'label': 'senderMaterialNumber',
                                'model': 'ai',
                                'name': 'senderMaterialNumber',
                                'page': 1,
                                'rawValue': 'Gadget',
                                'type': 'string',
                                'value': 'Gadget'},
                               {'category': 'details',
                                'confidence': 0.6637594699859619,
                                'coordinates': {'h': 0.012878787878787878,
                                                'w': 0.06029411764705883,
                                                'x': 0.17401960784313725,
                                                'y': 0.37537878787878787},
                                'description': 'customerMaterialNumber',
                                'label': 'customerMaterialNumber',
                                'model': 'ai',
                                'name': 'customerMaterialNumber',
                                'page': 1,
                                'rawValue': 'Gadget',
                                'type': 'string',
                                'value': 'Gadget'},
                               {'category': 'details',
                                'confidence': 0.8936874270439148,
                                'coordinates': {'h': 0.012878787878787878,
                                                'w': 0.05882352941176472,
                                                'x': 0.3514705882352941,
                                                'y': 0.37537878787878787},
                                'description': 'quantity',
                                'label': 'quantity',
                                'model': 'ai',
                                'name': 'quantity',
                                'page': 1,
                                'rawValue': '$15.00',
                                'type': 'number',
                                'value': 15.0},
                               {'category': 'details',
                                'confidence': 0.7852321267127991,
                                'coordinates': {'h': 0.012500000000000011,
                                                'w': 0.08872549019607845,
                                                'x': 0.4696078431372549,
                                                'y': 0.37537878787878787},
                                'description': 'unitPrice',
                                'label': 'unitPrice',
                                'model': 'ai',
                                'name': 'unitPrice',
                                'page': 1,
                                'rawValue': '$1,125.00',
                                'type': 'number',
                                'value': 1125.0}]]},
 'fileName': 'po.txt',
 'fileType': 'pdf',
 'finished': '2025-08-06T17:37:55.423454+00:00',
 'height': 2640,
 'id': '798c15df-251b-4f4e-a634-9a1090f5d2c3',
 'languageCodes': ['en'],
 'pageCount': 1,
 'schemaId': 'fbab052e-6f9b-4a5f-b42f-29a8162eb1bf',
 'schemaName': 'SAP_purchaseOrder_schema',
 'schemaVersion': '1',
 'status': 'DONE',
 'width': 2040}
```
 = Same can be seen in the SAP AI cockpit 
 
   <img width="1920" height="916" alt="{100F4694-4F18-4216-962C-70A1C864D85C}" src="https://github.com/user-attachments/assets/896230c3-4a7c-4ebe-a900-016592b0904c" />

   <img width="1901" height="329" alt="{4E1BB69D-6597-4DB9-B3D1-B122C325CF5E}" src="https://github.com/user-attachments/assets/18d3527d-58a9-40e1-b99e-2cc636b4b1c7" />

   
## ðŸ§© Architecture Overview

```plaintext
SAP DOX API  â†’  Extracted JSON  â†’  ZPL Generator  â†’  Labelary PDF Preview
         â†‘          â†“
     OAuth Token  .env config
